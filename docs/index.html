<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-07-08 Thu 10:51 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="ThanhVu (Vu) Nguyen" />
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#dig">1. DIG</a>
<ul>
<li><a href="#usage">1.1. Usage</a>
<ul>
<li><a href="#generating-invariants-from-a-program">1.1.1. Generating Invariants From a Program</a></li>
<li><a href="#other-programs">1.1.2. Other programs</a></li>
<li><a href="#generating-invariants-from-traces">1.1.3. Generating Invariants From Traces</a></li>
<li><a href="#additional-options">1.1.4. Additional Options</a></li>
</ul>
</li>
<li><a href="#setup">1.2. Setup</a>
<ul>
<li><a href="#using-docker">1.2.1. Using DOCKER</a></li>
<li><a href="#installing-dig">1.2.2. Installing DIG</a></li>
</ul>
</li>
<li><a href="#publications">1.3. Publications</a></li>
<li><a href="#acknowledgements">1.4. ACKNOWLEDGEMENTS</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-dig" class="outline-2">
<h2 id="dig"><span class="section-number-2">1</span> DIG</h2>
<div class="outline-text-2" id="text-dig">
<p>
<b>DIG</b> is a tool for generating program invariants at arbitrary program
locations (e.g., loop invariants, post conditions, etc). DIG infers
(potentially <b>nonlinear</b>) numerical invariants using symbolic states
extracted from a symbolic execution tool. DIG supports equalities such
as <code>x+y=5</code>, <code>x*y=z</code>, <code>x*3y^3 + 2*zw + pq + q^3 = 3</code>, inequalities such
as <code>x &lt;</code> y<sup>2</sup> + 3=, and min/max inequalities such as <code>max(x,y) &lt;</code> z + 2=.
The user can also use <i>terms</i> to represent desired information, e.g.,
<code>t = 2^x</code>, and have DIG infer invariants over terms.
</p>

<p>
DIG's numerical relations (in particular, nonlinear equalities) have
been used for - nonlinear program understanding and correctness checking
(<code>ICSE12</code>, <code>ICSE14</code>, <code>ASE17</code>, <code>FSE17</code>, <code>TOSEM13</code>) - complexity analysis
(e.g., providing program run time complexity such as <code>O(N^2)</code> or
<code>O(NM)</code>, <code>ASE17</code>, <code>FSE17</code>) - recurrence relations for complexity
analysis (e.g., finding recurrence relations for recursive programs such
as <code>T(n)=3*T(n/2) + f(n)</code>, <code>SEAD20</code>) - termination and non-termination
analyses (use nonlinear invariants to reason about ranking function for
termination and recurrent sets for non-termination, <code>OOPSLA20</code>) - array
analysis (finding invariant relations over array data structures, e.g.,
<code>A[i] = B[C[2i + 3]]</code>, <code>ICSE12</code>, <code>TOSEM13</code>)
</p>

<p>
DIG is written in Python using the <b>SAGE</b> mathematics system. It infers
invariants using dynamic execution (over execution traces) and checks
those invariants using symbolic states and constraint solving. DIG uses
symbolic execution (<b>Symbolic PathFinder</b> for Java and <b>CIVL</b> for C) to
collect symbolic states and the <b>Z3</b> SMT solver for constraint solving.
</p>

<p>
The current version of DIG works with programs written in Java, Java
bytecode, and C. The tool also infers invariants direclty from given
concrete program execution traces.
</p>

<hr />
</div>

<div id="outline-container-usage" class="outline-3">
<h3 id="usage"><span class="section-number-3">1.1</span> Usage</h3>
<div class="outline-text-3" id="text-usage">
<p>
You can use DIG to generate invariants from a
<a href="#generating-invariants-from-a-program">program</a> (either a Java file
<code>.java</code>, a bytecode file <code>.class</code>, or a C file <code>.c</code>), or a
<a href="#generating-invariants-from-traces">trace file</a> (a plain text file
consisting of concrete values of variables).
</p>
</div>

<div id="outline-container-generating-invariants-from-a-program" class="outline-4">
<h4 id="generating-invariants-from-a-program"><span class="section-number-4">1.1.1</span> Generating Invariants From a Program</h4>
<div class="outline-text-4" id="text-generating-invariants-from-a-program">
<p>
Consider the following <code>CohenDiv.java</code> program
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">in DIG's src directory</span>
<span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">$ less ../test/nla/CohenDiv.java</span>

<span style="color: #e45649;">public</span> <span style="color: #e45649;">class</span> <span style="color: #986801;">CohenDiv</span> {
     <span style="color: #e45649;">public</span> <span style="color: #e45649;">static</span> <span style="color: #986801;">void</span> <span style="color: #a626a4;">vtrace0</span>(<span style="color: #986801;">int</span> <span style="color: #6a1868;">q</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">r</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">a</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">b</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">x</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">y</span>){}
     <span style="color: #e45649;">public</span> <span style="color: #e45649;">static</span> <span style="color: #986801;">void</span> <span style="color: #a626a4;">vtrace1</span>(<span style="color: #986801;">int</span> <span style="color: #6a1868;">q</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">r</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">a</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">b</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">x</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">y</span>){}
     <span style="color: #e45649;">public</span> <span style="color: #e45649;">static</span> <span style="color: #986801;">void</span> <span style="color: #a626a4;">vtrace2</span>(<span style="color: #986801;">int</span> <span style="color: #6a1868;">x</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">y</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">q</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">r</span>){}

     <span style="color: #e45649;">public</span> <span style="color: #e45649;">static</span> <span style="color: #986801;">void</span> <span style="color: #a626a4;">main</span> (<span style="color: #986801;">String</span>[] <span style="color: #6a1868;">args</span>) {}
     <span style="color: #e45649;">public</span> <span style="color: #e45649;">static</span> <span style="color: #986801;">int</span> <span style="color: #a626a4;">mainQ</span>(<span style="color: #986801;">int</span> <span style="color: #6a1868;">x</span>, <span style="color: #986801;">int</span> <span style="color: #6a1868;">y</span>) {
          assert(x &gt;= 0);
          assert(y &gt;= 1);

          <span style="color: #986801;">int</span> <span style="color: #6a1868;">q</span>=0;
          <span style="color: #986801;">int</span> <span style="color: #6a1868;">r</span>=x;
          <span style="color: #986801;">int</span> <span style="color: #6a1868;">a</span>=0;
          <span style="color: #986801;">int</span> <span style="color: #6a1868;">b</span>=0;

          <span style="color: #e45649;">while</span>(<span style="color: #b751b6;">true</span>) {
               vtrace0(q,r,a,b,x,y);
               <span style="color: #e45649;">if</span>(<span style="color: #4078f2; font-weight: bold;">!</span>(r&gt;=y)) <span style="color: #e45649;">break</span>;
               a=1;
               b=y;

               <span style="color: #e45649;">while</span> (<span style="color: #b751b6;">true</span>) {
                    vtrace1(q,r,a,b,x,y);
                    <span style="color: #e45649;">if</span>(<span style="color: #4078f2; font-weight: bold;">!</span>(r &gt;= 2*b)) <span style="color: #e45649;">break</span>;

                    a = 2*a;
                    b = 2*b;
               }
               r=r-b;
               q=q+a;
          }

          vtrace2(x,y,q,r);
          <span style="color: #e45649;">return</span> q;
     }
}
</pre>
</div>

<ul class="org-ul">
<li>To find invariants at some location, we declare a function <code>vtraceX</code>
where <code>X</code> is some distinct number and call that function at that
location.

<ul class="org-ul">
<li>For example, in <code>CohenDiv.java</code>, we call <code>vtrace0</code>, <code>vtrace1</code> at the
head of the outter and inner while loops find loop invariants and
<code>vtrace2</code> before the function exit to find post conditions.</li>
<li><code>vtraceX</code> takes a list of arguments that are variables in scope at
the desired location. This tells DIG to find invariants over these
variables.</li>
</ul></li>

<li>Next, we run DIG on <code>CohenDiv.java</code> or its byteclass version (compiled
with <code>javac -g</code>) and discover the following invariants at <code>vtracesX</code>
locations:</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">in DIG's src directory</span>
tnguyen@origin ~/d/src (dev)&gt; sage -python -O dig.py  ../tests/paper/CohenDiv.java -log 3
settings:INFO:2020-10-03 21:39:01.995144: dig.py ../tests/paper/CohenDiv.java -log 3
alg:INFO:analyze <span style="color: #50a14f;">'../tests/paper/CohenDiv.java'</span>
alg:INFO:compute symbolic states (18.65s)
alg:INFO:infer invs at 3 locs: vtrace0, vtrace2, vtrace1
alg:INFO:found 5 eqts (26.55s)
alg:INFO:found 67 ieqs (1.10s)
alg:INFO:found 377 minmax (2.55s)
alg:INFO:test 449 invs using 699 traces (0.93s)
alg:INFO:simplify 449 invs (1.79s)
* prog CohenDiv locs 3;  invs 25 (Eqt: 5, MP: 1, Oct: 19) V 6 T 3 D 2;  NL 5 (2) ;
-&gt; time eqts 26.5s, ieqs 1.1s, minmax 2.5s, simplify 2.7s, symbolic_states 18.7s, total 51.9s
-&gt; checks  0 () change depths 0 () change vals 0 ()
-&gt; max  0 () change depths 0 ()
runs 1
rand seed 1601779141.99, test (6, 59)
<span style="color: #a626a4;">vtrace0</span> (11 invs):
1. a*y - b == 0
2. q*y + r - x == 0
3. -r &lt;= 0
4. -a &lt;= 0
5. a - b &lt;= 0
6. a - q &lt;= 0
7. q - x &lt;= 0
8. r - x &lt;= 0
9. b - x &lt;= 0
10. -a - y &lt;= -1
11. min(q, y) - b &lt;= 0
<span style="color: #a626a4;">vtrace1</span> (8 invs):
1. a*y - b == 0
2. q*y + r - x == 0
3. -q &lt;= 0
4. b - r &lt;= 0
5. a - b &lt;= 0
6. r - x &lt;= 0
7. -b + y &lt;= 0
8. -a - y &lt;= -2
<span style="color: #a626a4;">vtrace2</span> (6 invs):
1. q*y + r - x == 0
2. -r &lt;= 0
3. -q &lt;= 0
4. q - x &lt;= 0
5. r - x &lt;= 0
6. r - y &lt;= -1
tmpdir: /var/tmp/dig_2282784602713568709_x0qxjt3s
</pre>
</div>
</div>
</div>

<div id="outline-container-other-programs" class="outline-4">
<h4 id="other-programs"><span class="section-number-4">1.1.2</span> Other programs</h4>
<div class="outline-text-4" id="text-other-programs">
<ul class="org-ul">
<li>The directory <code>../benchmarks/java/nla</code> contains many programs having
nonlinear invariants.</li>
</ul>
</div>
</div>

<div id="outline-container-generating-invariants-from-traces" class="outline-4">
<h4 id="generating-invariants-from-traces"><span class="section-number-4">1.1.3</span> Generating Invariants From Traces</h4>
<div class="outline-text-4" id="text-generating-invariants-from-traces">
<p>
DIG can infer invariants directly from a file consisting of concreting
program execution traces. Below is an example of traces generated when
running the above <code>CohenDiv</code> program with various inputs
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">in DIG's src directory</span>
$ less ../test/traces/CohenDiv.tcs
vtrace1: I q, I r, I a, I b, I x, I y
vtrace1: 4, 8, 1, 4, 24, 4
vtrace1: 16, 89, 1, 13, 297, 13
vtrace1: 8, 138, 4, 76, 290, 19
vtrace1: 0, 294, 8, 192, 294, 24
vtrace1: 64, 36, 4, 16, 292, 4
...
vtrace2: I x, I y, I q, I r
vtrace2: 280, 24, 11, 16
vtrace2: 352, 11, 32, 0
vtrace2: 22, 298, 0, 22
vtrace2: 274, 275, 0, 274
vtrace2: 2, 287, 0, 2
...
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">in DIG's src directory</span>
tnguyen@debian ~/d/src&gt; sage -python -O dig.py ../tests/traces/CohenDiv.tcs -log 3
settings:INFO:2020-06-30 15:26:53.384339: dig.py ../tests/traces/CohenDiv.tcs -log 3
alg:INFO:analyze <span style="color: #50a14f;">'../tests/traces/CohenDiv.tcs'</span>
alg:INFO:test 30 invs using 181 traces (0.96s)
alg:INFO:simplify 26 invs (0.42s)
<span style="color: #a626a4;">vtrace1</span> (6 invs):
<span style="color: #a626a4;">vtrace1</span> (8 invs):
1. q*y + r - x == 0
2. -q &lt;= 0
3. -r &lt;= 0
4. -y &lt;= -1
5. r - x &lt;= 0
6. q - x &lt;= 0
7. -r - x &lt;= -2
8. -x - y &lt;= -10
<span style="color: #a626a4;">vtrace2</span> (8 invs):
1. q*y + r - x == 0
2. -q &lt;= 0
3. -r &lt;= 0
4. r - x &lt;= 0
5. q - x &lt;= 0
6. r - y &lt;= -1
7. -r - x &lt;= -2
8. -x - y &lt;= -10
....
</pre>
</div>

<p>
Note that if we just run Dig over traces, then most of the generated
inequality results are spurious, i.e., they are correct with the given
traces, but not real invariants. If given the program source code as
<a href="#generating-invariants-from-a-program">shown above</a>, DIG can check
and remove spurious results.
</p>
</div>
</div>

<div id="outline-container-additional-options" class="outline-4">
<h4 id="additional-options"><span class="section-number-4">1.1.4</span> Additional Options</h4>
<div class="outline-text-4" id="text-additional-options">
<p>
Most of DIG's behaviors can be controlled by the users (the
<code>src\settings.py</code> lists all the defaut parameters). Use <code>-h</code> or <code>--help</code>
to see options that can be passed into DIG. Below we show several ones
</p>
</div>

<ol class="org-ol">
<li><a id="specify-max-degree-for-equalities"></a>Specify max degree for equalities<br />
<div class="outline-text-5" id="text-specify-max-degree-for-equalities">
<p>
By default, DIG automatically to find equalities up to certain degree.
We can specify this degree directly with <code>-maxdeg X</code>
</p>

<div class="org-src-container">
<pre class="src src-sh">tnguyen@debian ~/dig/src&gt; sage -python -O dig.py  ../tests/paper/CohenDiv.java   -log 3 -maxdeg 2 -noieqs  <span style="color: #9ca0a4;">#</span><span style="color: #9ca0a4;">find equalities up to degree 2 and donot infer inequalities</span>
...
</pre>
</div>
</div>
</li>

<li><a id="customizing-inequalities"></a>Customizing Inequalities<br />
<div class="outline-text-5" id="text-customizing-inequalities">
<p>
By default, DIG infers octagonal inequalities (i.e., linear inequalities
among 2 variables with coefs in in the set {-1,0,1}). But we can
customize DIG to find more expression inequalities (of course, with the
trade-off that it takes more time to generate more expressive invs).
</p>

<p>
Below we use a different example <code>Sqrt1.java</code> to demonstrate
</p>

<div class="org-src-container">
<pre class="src src-sh">tnguyen@debian ~/dig/src&gt; sage -python -O dig.py  ../tests/paper/CohenDiv.java  -log 3  -noeqts  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">for demonstration, only find default, octagonal, ieq's.</span>
...
1. a &lt;= 10
2. a - n &lt;= 0
3. -t &lt;= -1
4. -s &lt;= -1
5. -n + t &lt;= 2
6. -a &lt;= 0


tnguyen@debian ~/dig/src&gt; sage -python -O dig.py  ../tests/paper/Sqrt1.java  -log 4 -noeqts -ideg 2  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">find nonlinear octagonal inequalities</span>
...
1. a*s - n*t &lt;= 1
2. a &lt;= 10
3. -t &lt;= -1
4. -s &lt;= -1
5. -n*t + s &lt;= 1
6. -n*s + t &lt;= 1
7. -n*s + a*t &lt;= 0
8. -n + t &lt;= 2
9. -a*n + t &lt;= 2
10. -a*n + s &lt;= 3
11. -a &lt;= 0

tnguyen@debian ~/dig/src&gt; timeout 900 sage -python -O dig.py  ../tests/paper/Sqrt1.java  -log 4 -noeqts -icoefs 2  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">find linear inequalities with coefs in {2,-1,0,1,2}</span>
...
1. a &lt;= 10
2. 2*a - n &lt;= 1
3. -t &lt;= -1
4. -s &lt;= -1
5. -n + 2*t &lt;= 6
6. -a &lt;= 0
7. -2*n + t &lt;= 1
8. -2*n + s &lt;= 2
</pre>
</div>

<hr />
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-setup" class="outline-3">
<h3 id="setup"><span class="section-number-3">1.2</span> Setup</h3>
<div class="outline-text-3" id="text-setup">
<p>
First, clone DIG
</p>

<div class="org-src-container">
<pre class="src src-sh">git clone https://github.com/unsat/dig.git
</pre>
</div>

<p>
Then go to DIG's directory (<code>cd dig</code>). Also make sure that you're in the
right branch (e.g., <code>master</code> or <code>dev</code>). To run DIG, you can either use
the <a href="#using-docker">provided <i>docker</i> script</a> (easiest way) or
<a href="#installing-dig">install DIG yourself</a>.
</p>
</div>

<div id="outline-container-using-docker" class="outline-4">
<h4 id="using-docker"><span class="section-number-4">1.2.1</span> Using DOCKER</h4>
<div class="outline-text-4" id="text-using-docker">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">in DIG's directory</span>

<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">build the docker image,</span>
$ docker build . -t=<span style="color: #50a14f;">'dig'</span>
...
...
<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">this will take some time as it will build a Linux image with all necessary dependencies to run DIG.  </span>

<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">then run dig</span>
$ docker run -it dig

<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">docker will drop you into a Linux prompt like below.</span>
$ root@b53e0bd86c11:/dig/src#
</pre>
</div>

<p>
You are now ready to use DIG, see instructions in the <a href="#usage">USAGE</a>
section
</p>
</div>
</div>

<div id="outline-container-installing-dig" class="outline-4">
<h4 id="installing-dig"><span class="section-number-4">1.2.2</span> Installing DIG</h4>
<div class="outline-text-4" id="text-installing-dig">
<p>
You can also install DIG yourself. The tool has been tested using the
following setup:
</p>

<ul class="org-ul">
<li>Debian Linux 9 or 10 (64 bit)</li>
<li>SageMath <code>9.0</code> (64 bit)</li>
<li>Microsoft Z3 SMT solver <code>4.8.3</code></li>
<li>Java JDK (Oracle <code>1.8.0_121</code> or OpenJDK <code>1.8.0_122</code>)</li>
<li>Java PathFinder and Symbolic Finder:

<ul class="org-ul">
<li>JPF (<code>java-8</code> branch, commit
<a href="https://github.com/javapathfinder/jpf-core/commit/18a0c42de3e80be0c2ddcf0d212e376e576fcda0"><code>18a0c42de3e80be0c2ddcf0d212e376e576fcda0</code></a>)</li>
<li>SPF (commit
<a href="https://github.com/SymbolicPathFinder/jpf-symbc/commit/98a0e08fee323c15b651110dd3c28b2ce0c4e274"><code>98a0e08fee323c15b651110dd3c28b2ce0c4e274</code></a>)</li>
</ul></li>
</ul>
</div>

<ol class="org-ol">
<li><a id="installing-sage-and-z3"></a>Installing SAGE and Z3<br />
<div class="outline-text-5" id="text-installing-sage-and-z3">
<ul class="org-ul">
<li>Setup SAGE: download a precompiled
<a href="http://mirrors.mit.edu/sage/linux/64bit/index.html">SageMath</a>
binary</li>
<li>Setup Z3: <a href="https://github.com/Z3Prover/z3/releases">download</a> and
build Z3 by following the instructions in its README file</li>
<li>To check that you have all needed stuff</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">in DIG's src directory</span>
$ cd src
$ sage helpers/check_requirements.py
...
...
Everything seems OK. Have fun with DIG!
</pre>
</div>
</div>
</li>

<li><a id="for-java-files-install-java-and-symbolic-pathfinder"></a>For Java files: install Java and Symbolic PathFinder<br />
<div class="outline-text-5" id="text-for-java-files-install-java-and-symbolic-pathfinder">
<ul class="org-ul">
<li>Install Java 8: either the JDK from Oracle 1.8.0\<sub>121</sub> or the OpenJDK
packaged in Debian (<code>apt-get install -y default-jdk</code>, besure the
version is 1.8.0\<sub>121</sub> or 1.8.0\<sub>122</sub>).</li>

<li>Install both Java PathFinder and the Symbolic Pathfinder extension</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ mkdir /PATH/TO/JPF
$ cd /PATH/TO/JPF
$ git clone https://github.com/javapathfinder/jpf-core <span style="color: #9ca0a4;">#</span><span style="color: #9ca0a4;">JPF</span>
$ git clone https://github.com/SymbolicPathFinder/jpf-symbc <span style="color: #9ca0a4;">#</span><span style="color: #9ca0a4;">Symbolic extension</span>

<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">build jpf</span>
$ cd jpf-core
$ git checkout java-8  <span style="color: #9ca0a4;">#</span><span style="color: #9ca0a4;">switch to the java-8 branch</span>
$ ant

<span style="color: #9ca0a4;">#</span><span style="color: #9ca0a4;">copy patched Listener file to SPF</span>
$ cp /PATH/TO/dig/src/java/InvariantListenerVu.java jpf-symbc/src/main/gov/nasa/jpf/symbc

<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">build spf</span>
$ cd jpf-symbc
$ ant

<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">sometimes it helps to rebuild jpf-core again</span>
<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">cd jpf-core</span>
$ ant


<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">Add the following to `~/.jpf/site.properties` (create `~/.jpf` if it doesn't exist)</span>
jpf-core = /PATH/TO/JPF/jpf-core
jpf-symbc = /PATH/TO/JPF/jpf-symbc
<span style="color: #6a1868;">extensions</span>=${<span style="color: #6a1868;">jpf</span>-core},${<span style="color: #6a1868;">jpf</span>-symbc}
</pre>
</div>

<ul class="org-ul">
<li>Compile Java files in <code>java</code> directory for instrumenting Java byte
classes</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">in DIG's src directory</span>
$ cd src/java
$ make
</pre>
</div>
</div>
</li>

<li><a id="orgf39c15f"></a>For C files: install the [[<a href="https://vsl.cis.udel.edu/civl/">https://vsl.cis.udel.edu/civl/</a>][CIVL<br />
<div class="outline-text-5" id="text-1-2-2-3">
<p>
symbolic execution tool]]
</p>
<p>
:CUSTOM<sub>ID</sub>: for-c-files-install-the-civl-symbolic-execution-tool
</p>

<ul class="org-ul">
<li>Build CIL</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">build CIL</span>
$ git clone https://github.com/cil-project/cil.git
$ cd cil
$ ./configure ; make
</pre>
</div>

<ul class="org-ul">
<li>Compile the Ocaml files in <code>ocaml</code> directory for instrumenting C files
(to CIVL format)</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">in DIG's src directory</span>
$ cd src/ocaml
$ edit Makefile  <span style="color: #9ca0a4;">#</span><span style="color: #9ca0a4;">point the OCAML_OPTIONS to where CIL is</span>
$ make
</pre>
</div>

<ul class="org-ul">
<li>Get CIVL</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ wget --no-check-certificate https://vsl.cis.udel.edu/lib/sw/civl/1.20/r5259/release/CIVL-1.20_5259.tgz
$ tar xf CIVL-1.20_5259.tgz
$ ln -sf CIVL-1.20_5259 civl
$ ln -sf civl/lib/ lib


<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">Tell CIVL to use Z3  by editing the ~/.sarl file</span>
prover {
 aliases = z3;
 kind = Z3;
 version = <span style="color: #50a14f;">"4.8.7 - 64 bit"</span>;
 path = <span style="color: #50a14f;">"/home/SHARED/Devel/Z3/z3/z3"</span>;
 timeout = 10.0;
 showQueries = false;
 showInconclusives = false;
 showErrors = true;
}

<span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">test CIVL</span>
$ /home/SHARED/Devel/JAVA/jdk/bin/java -jar /home/SHARED/Devel/CIVL/lib/civl-1.20_5259.jar verify -maxdepth=20 $<span style="color: #6a1868;">DIG</span>/tests/tools/cohendiv_civl.c
CIVL v1.20 of 2019-09-27 -- http://vsl.cis.udel.edu/civl
vtrace1: q = 0; r = X_x; a = 0; b = 0; x = X_x; y = X_y
path condition: (0&lt;=(X_x-1))&amp;&amp;(0&lt;=(X_y-1))
...
</pre>
</div>
</div>
</li>

<li><a id="setup-paths"></a>Setup Paths<br />
<div class="outline-text-5" id="text-setup-paths">
<ul class="org-ul">
<li>Put the following in your <code>~/.sh_profile</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">~/.sh_profile</span>
<span style="color: #a626a4;">export</span> <span style="color: #6a1868;">Z3</span>=PATH/TO/z3   <span style="color: #9ca0a4;">#</span><span style="color: #9ca0a4;">Z3 dir</span>
<span style="color: #a626a4;">export</span> <span style="color: #6a1868;">SAGE</span>=PATH/TO/sage  <span style="color: #9ca0a4;">#</span><span style="color: #9ca0a4;">where your SAGE dir is</span>
<span style="color: #a626a4;">export</span> <span style="color: #6a1868;">PYTHONPATH</span>=$<span style="color: #6a1868;">Z3</span>/src/api/python:$<span style="color: #6a1868;">PYTHONPATH</span>
<span style="color: #a626a4;">export</span> <span style="color: #6a1868;">JAVA_HOME</span>=/PATH/TO/JAVA
<span style="color: #a626a4;">export</span> <span style="color: #6a1868;">PATH</span>=$<span style="color: #6a1868;">SAGE</span>:$<span style="color: #6a1868;">JAVA_HOME</span>/bin:$<span style="color: #6a1868;">PATH</span>
<span style="color: #a626a4;">export</span> <span style="color: #6a1868;">JPF_HOME</span>=/PATH/TO/JPF
<span style="color: #a626a4;">export</span> <span style="color: #6a1868;">LD_LIBRARY_PATH</span>=$<span style="color: #6a1868;">LD_LIBRARY_PATH</span>:$<span style="color: #6a1868;">JPF_HOME</span>/jpf-symbc/lib/
</pre>
</div>

<ul class="org-ul">
<li>Some troubleshooting tips:

<ul class="org-ul">
<li>Make sure SAGE works, e.g., <code>sage</code> to run the SAGE interpreter or
<code>sage --help</code></li>
<li>Make sure Z3 is installed correctly so that you can do
<code>sage -c "import z3; z3.get_version()"</code> without error.</li>
<li>Use DIG with <code>-log 4</code> to enable detail logging information, also
look at the <code>settings.py</code> for various settings on where DIG looks
for external programs such as <code>java</code> and <code>javac</code></li>
</ul></li>
</ul>

<hr />
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-publications" class="outline-3">
<h3 id="publications"><span class="section-number-3">1.3</span> Publications</h3>
<div class="outline-text-3" id="text-publications">
<p>
Technical information about DIG can be found from these papers. The
<code>SymInfer paper (ASE17)</code> is probably a good start.
</p>

<ul class="org-ul">
<li>Ton Chanh Le, Timos Antonopoulos, Parisa Fathololumi, Eric Koskinen,
ThanhVu Nguyen. DynamiTe: Dynamic Termination and Non-termination
Proofs. Proc. ACM Program. Lang. (OOPSLA), 2020</li>
<li>ThanhVu Nguyen, Didier Ishimwe, Alexey Malyshev, Timos Antonopoulos,
and Quoc-Sang Phan. Using Dynamically Inferred Invariants to Analyze
Program Runtime Complexity. Workshop on Software Security from Design
to Deployment, 2020</li>
<li>ThanhVu Nguyen, Matthew Dwyer, and William Visser. SymInfer: Inferring
Program Invariants using Symbolic States. In Automated Software
Engineering (ASE). IEEE, 2017.</li>
<li>ThanhVu Nguyen, Timos Antopoulos, Andrew Ruef, and Michael Hicks. A
Counterexample-guided Approach to Finding Numerical Invariants. In
11th Joint Meeting on Foundations of Software Engineering (ESEC/FSE),
pages 605&#x2013;615. ACM, 2017.</li>
<li>ThanhVu Nguyen, Deepak Kapur, Westley Weimer, and Stephanie Forrest.
DIG: A Dynamic Invariant Generator for Polynomial and Array
Invariants. Transactions on Software Engineering Methodology (TOSEM),
23(4):30:1&#x2013;30:30, 2014.</li>
<li>ThanhVu Nguyen, Deepak Kapur, Westley Weimer, and Stephanie Forrest.
Using Dynamic Analysis to Generate Disjunctive Invariants. In 36th
International Conference on Software Engineering (ICSE), pages
608&#x2013;619. IEEE, 2014.</li>
<li>ThanhVu Nguyen, Deepak Kapur, Westley Weimer, and Stephanie Forrest.
Using Dynamic Analysis to Discover Polynomial and Array Invariants. In
34th International Conference on Software Engineering (ICSE), pages
683&#x2013;693. IEEE, 2012. <code>Distinguish Paper award</code></li>
</ul>
</div>
</div>

<div id="outline-container-acknowledgements" class="outline-3">
<h3 id="acknowledgements"><span class="section-number-3">1.4</span> ACKNOWLEDGEMENTS</h3>
<div class="outline-text-3" id="text-acknowledgements">
<ul class="org-ul">
<li>This project is supported in part by NSF grant CCF-1948536 and ARO
grant W911NF-19-1-0054.</li>
</ul>
</div>
</div>
</div>
</div>
</body>
</html>
